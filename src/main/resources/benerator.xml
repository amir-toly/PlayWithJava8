<?xml version="1.0" encoding="iso-8859-1"?>
<setup xmlns="http://databene.org/benerator/0.8.1"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://databene.org/benerator/0.8.1 http://databene.org/benerator-0.8.1.xsd">

    <import defaults="true"
            domains="person,address" class="org.databene.commons.TimeUtil"
            />

    <bean id="csvConsumer" class="CSVEntityExporter">
        <property name="uri" value="src/main/resources/users.csv"/>
        <property name="columns" value="firstname,lastname,login,password,birthday,startDate,endDate,billingStreet,billingCity,billingPostalCode,deliveryStreet,deliveryCity,deliveryPostalCode"/>
    </bean>

    <bean id="dateGenerator" class="DateTimeGenerator">
        <property name='minDate' value='2000-01-01'/>
        <property name='maxDate' value='2020-12-31'/>
        <property name='dateDistribution' value='random'/>
        <property name='minTime' value='08:00:00'/>
        <property name='maxTime' value='17:00:00'/>
        <property name='timeGranularity' value='00:00:01'/>
        <property name='timeDistribution' value='random'/>
    </bean>
    <bean id="firstLetterExtract" class="SubstringExtractor">
        <property name='from' value='0'/>
        <property name='to' value='1'/>
    </bean>
    <bean id="passwordGenerator" class="StringGenerator">
        <property name='unique' value='true'/>
        <property name='minLength' value='10'/>
        <property name='maxLength' value='10'/>
    </bean>


    <generate type="User" pageSize="1000" count="1000" consumer="csvConsumer">
        <variable name="userInformation" generator="PersonGenerator" dataset="FR" locale="fr"/>
        <variable name="billingAddress" generator="AddressGenerator" dataset="FR" locale="FR" />
        <variable name="deliveryAddress" generator="AddressGenerator" nullQuota="0.1" dataset="FR" locale="FR" />
        <attribute name="lastname" type="String" script="userInformation.familyName"/>
        <attribute name="firstname" type="String" script="userInformation.givenName"/>
        <variable name="firstnameFirstLetter" converter="firstLetterExtract"/>
        <attribute name="login" type="String" script="firstnameFirstLetter+this.lastname"
                   converter="ToLowerCaseConverter"/>
        <attribute name="password" type="String" generator="passwordGenerator" converter="ToLowerCaseConverter"/>
        <attribute name="birthday" type="timestamp" script="userInformation.birthDate"/>
        <attribute name="startDate" type="timestamp" generator="dateGenerator"/>
        <variable name="endDateIncrement" type="int" min="1" max="500"/>`
        <attribute name="endDate" type="timestamp" script="TimeUtil.addDays(this.startDate, endDateIncrement)"/>
        <attribute name="billingStreet" type="string"  script="billingAddress.houseNumber+' '+billingAddress.street"/>
        <attribute name="billingCity" type="string" script="billingAddress.city"/>
        <attribute name="billingPostalCode" type="string" script="billingAddress.postalCode"/>
        <attribute name="deliveryStreet" type="string"  script="deliveryAddress.houseNumber+' '+deliveryAddress.street"/>
        <attribute name="deliveryCity" type="string" script="deliveryAddress.city"/>
        <attribute name="deliveryPostalCode" type="string" script="deliveryAddress.postalCode"/>
    </generate>


</setup>